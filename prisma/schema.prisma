generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Cliente{
  id Int @id @default(autoincrement())
  nombre String 
  apellido String
  cedula String @unique
  telefono String @unique
  direccion String @unique
  correo String @unique
  pedidos Pedido[]
  activo Boolean @default(true)
}

model Empleado{
  id Int @id @default(autoincrement())
  nombre_usuario String
  clave String
  nombre String
  apellido String
  cedula String @unique
  telefono String @unique
  direccion String 
  correo String
  compras Compra[]
  pedido Pedido[]
  activo Boolean @default(true)
}

model Proveedor{
  id Int @id @default(autoincrement())
  nombre String
  apellido String
  cedula String @unique
  telefono String @unique
  direccion String 
  correo String @unique
  activo Boolean @default(true)
  materia_prima MateriaPrima[]
}

model MateriaPrima{
  id Int @id @default(autoincrement())
  nombre String
  descripcion String
  precio_unitario Decimal
  existencias Int
  existencias_minimas Int
  Proveedor Proveedor @relation(fields: [id_proveedor], references: [id])
  id_proveedor Int
  detalles_compra DetalleCompra[]
  detalles_produccion DetalleProduccion[]

}


model Compra{
  id Int @id @default(autoincrement())
  Empleado Empleado @relation(fields: [id_empleado], references: [id])
  id_empleado Int
  fecha DateTime @default(now())
  detalle_compra DetalleCompra[]
}

model DetalleCompra{
  id Int @id @default(autoincrement())
  Compra Compra @relation(fields: [compra_id],references: [id])
  compra_id Int
  MateriaPrima MateriaPrima @relation(fields: [id_materia_prima],references: [id])
  id_materia_prima Int
  cantidad Int
  descuento Decimal
}


model Produccion{
  id Int @id @default(autoincrement())
  fecha_inicio DateTime
  fecha_finalizacion DateTime
  costo_mano_de_obra Decimal
  activo Boolean @default(true)
  detalles DetalleProduccion[]
  pedidos Pedido[]
}

model DetalleProduccion{
  id Int @id @default(autoincrement())
  Produccion Produccion @relation(fields: [id_produccion],references: [id])
  id_produccion Int
  MateriaPrima MateriaPrima @relation(fields: [materia_prima_id], references: [id])
  materia_prima_id Int
  cantidad_utilizada Int
}

model Pedido{
  id Int @id @default(autoincrement())
  detalle_pedido String
  Empleado Empleado @relation(fields:[id_empleado],references: [id])
  id_empleado Int
  Cliente Cliente @relation(fields: [id_cliente],references: [id])
  id_cliente Int
  Produccion Produccion @relation(fields: [id_produccion],references: [id])
  id_produccion Int
  precio_pedido Decimal
  dinero_abonado Decimal
  fecha_pedido DateTime
  fecha_entrega DateTime
  cancelado Boolean @default(false)
  activo  Boolean @default(true)
}
